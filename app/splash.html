<!DOCTYPE html>
<html>

<head>
    <title>LaF</title>
    <style>
        body {
            background-image: url("img/splash.png");
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
            background-repeat: no-repeat;        
            position: absolute;
            top: 0;
            bottom: 0;
            right: 0;
            left: 0;
            margin: 0;
        }

        @font-face {
            font-family: "源真ゴシックP Light";
            src: url("fonts/GenShinGothic-P-Light.ttf");
        }

        @font-face {
            font-family: "源真ゴシックP Medium";
            src: url("fonts/GenShinGothic-P-Medium.ttf");
        }

        * {
            outline: none;
            font-family: "源真ゴシックP Light";
        }

        #appVersion {
            position: absolute;
            font-family: "源真ゴシックP Medium" !important;
            color: rgba(77, 77, 77, 1);
            left: 15px;
            top: 10px;
            font-size: 20px;
        }

        #message {
            position: absolute;
            font-family: "源真ゴシックP Medium" !important;
            text-align: right;
            color: rgba(77, 77, 77, 1);
            right: 15px;
            top: 10px;
            font-size: 15px;
        }

        #updateStatus {
            position: absolute;
            color: rgba(77, 77, 77, 1);
            left: 10px;
            bottom: 10px;
            font-size: 15px;
        }

        #downloadStatus {
            position: absolute;
            color: rgba(77, 77, 77, 1);
            right: 10px;
            bottom: 10px;
            font-size: 15px;
        }
    </style>
</head>

<body>
    <div id="appVersion"></div>
    <div id="message">
        Thanks for over 1k Downlaods!</br>
        1000ダウンロード突破しました！ありがとうございます！
    </div>
    <div id="updateStatus"></div>
    <div id="downloadStatus"></div>
    <script type="text/javascript">
        const { ipcRenderer } = require("electron");
        const langRes = require("./lang")

        appv = document.getElementById("appVersion");
        updates = document.getElementById("updateStatus");
        dls = document.getElementById("downloadStatus");

        let appVersion = null;

        ipcRenderer.send("GET_VERSION")
        ipcRenderer.on("GET_VERSION", (e, v) => {
            appVersion = v
            appv.innerHTML = `v${appVersion}`;
        });

        ipcRenderer.send("GET_LANG")
        ipcRenderer.on("GET_LANG", (e, v) => {
            if (v === "ja_JP") {
                langPack = new langRes.ja_JP();
            } else {
                langPack = new langRes.en_US();
            }
        })

        ipcRenderer.on('checking-for-update', () => {
            updates.innerHTML = langPack.checkingForUpdate;
        });
        ipcRenderer.on('update-available', (event, info) => {
            updates.innerHTML = langPack.updateAvailable + info.version;
        });
        ipcRenderer.on('update-not-available', () => {
            updates.innerHTML = langPack.updateNotAvailable;
        });
        ipcRenderer.on('download-progress', (event, info) => {
            updates.innerHTML = langPack.downloadProgress;
            dls.innerHTML = `${Math.floor(info.percent)}% (${Math.floor(info.bytesPerSecond / 1000)} kB/s)`;
        });
        ipcRenderer.on('update-downloaded', (event, info) => {
            updates.innerHTML = langPack.updateDownloaded.replace("%appVersion%", info.version);
            dls.innerHTML = ""
        });
        ipcRenderer.on('update-error', () => {
            updates.innerHTML = langPack.updateError;
            dls.innerHTML = ""
        });
    </script>
</body>
</html>